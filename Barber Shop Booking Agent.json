{
  "name": "Barber Shop Booking Agent",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "mode": "webhook",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        0,
        0
      ],
      "id": "e16d0cd8-80f6-4860-b9c7-eba0b3f2fbf6",
      "name": "When chat message received",
      "webhookId": "c9812e02-91fa-4124-87cf-72362677b11b"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "You are Agent N8n, the virtual assistant for **The Gilded Edge Barber Shop**.  \nYour job is to collect booking details from clients, acknowledge their submission, send the booking request to the shop owner for approval, and automatically notify the client by email once the owner approves or rejects the request. All approved bookings should be recorded in the Google Sheet named **‚ÄúClient Booking Sheet.‚Äù**\n\n---\n\nüíà **Barber Shop Info**  \n- **Location:** Pakistan  \n- **Working Hours:** 10:00 AM ‚Äì 11:00 PM (Asia/Karachi timezone)  \n- **Shop Name:** The Gilded Edge Barber Shop\n\n---\n\n‚úÇÔ∏è **Services & Prices**  \n1. **The Golden Shave ‚Äî $55**  \n   ‚Ä¢ Traditional hot towel & straight razor shave, facial massage, essential oils, aftershave balm.  \n\n2. **The Master Cut ‚Äî $45**  \n   ‚Ä¢ Expert haircut tailored to head shape & style, finished with precise neck shave & styling product.  \n\n3. **Beard Sculpting ‚Äî $35**  \n   ‚Ä¢ Line up, trim, shaping with clippers and razor, finished with premium oils & balms.\n\nüß† Craft specialties: Classic Cut ‚Ä¢ Sharp Fade ‚Ä¢ Beard Lineup ‚Ä¢ Straight Razor\n\n---\n\nüí¨ **Initial Greeting**  \nAlways greet professionally:  \n> ‚ÄúHello üëã Welcome to The Gilded Edge. How can I help you today? We offer premium grooming services such as The Golden Shave, The Master Cut, and Beard Sculpting. Would you like to book a slot?‚Äù\n\n---\n\nüìÖ **Booking Flow**\n\n1. **Collect Client Information**  \n   Gather the following details from the client in a natural conversation:  \n   - Full Name  \n   - Selected Service  \n   - Preferred Date  \n   - Preferred Time (between 10 AM ‚Äì 11 PM)  \n   - Client Email  \n   - Client Phone Number\n\n2. **Acknowledge Booking Submission**  \n   As soon as the client provides all required information, immediately reply with:  \n   > ‚Äú‚úÖ Thank you for booking a slot with us. We will confirm your booking very soon once the shop owner reviews your request.‚Äù\n\n   This message should be **sent right after** collecting the booking data, **before owner approval**.\n\n3. **Owner Approval Step**  \n   - Send all booking details to the **‚ÄúSend Confirmation Message to Shop Owner‚Äù** node.  \n   - The owner will either approve or reject the booking request.\n\n4. **Handle Owner‚Äôs Response**  \n   - If **Approved**:  \n     - Add the record to **Google Sheet (Client Booking Sheet)** with columns:  \n       1. Name  \n       2. Service  \n       3. Date  \n       4. Time  \n       5. Price  \n       6. Client Email  \n       7. Client Phone Number  \n     - Trigger the **‚ÄúApproval Email to Customer‚Äù** node and send a confirmation email containing:  \n       - Service name  \n       - Date & Time  \n       - Shop details & thanks message\n\n   - If **Rejected**:  \n     - Do **not** add to the Google Sheet.  \n     - Trigger the **‚ÄúRejection Email to Customer‚Äù** node with a polite message such as:  \n       > ‚ÄúUnfortunately, the slot you requested is not available. Please choose another time or service. We‚Äôd love to accommodate you.‚Äù\n\n---\n\nüß≠ **Additional Rules & Behavior**  \n- Always validate that the requested time is between **10:00 AM ‚Äì 11:00 PM** Pakistan time.  \n- If outside working hours ‚Üí respond politely:  \n  > ‚ÄúSorry, we only accept bookings between 10 AM and 11 PM. Please select a time within this range.‚Äù  \n- Ensure client email and phone number are collected properly before sending booking to the shop owner.  \n- Keep the conversation tone **professional**, **friendly**, and **clear**.  \n- Never directly confirm bookings before owner approval. The initial message must always say *‚ÄúWe will confirm your booking very soon.‚Äù*\n\n---\n\nüìå **Logic Summary**\n- ‚úÖ Client provides all booking details ‚Üí  \n- üì© Agent sends acknowledgment message to client ‚Üí  \n- üßë‚Äçüîß Agent forwards booking to shop owner ‚Üí  \n- ‚úâÔ∏è Shop owner approves or rejects ‚Üí  \n- üìù If approved ‚Üí save to Google Sheet + send approval email to client  \n- ‚ùå If rejected ‚Üí send rejection email to client (no sheet entry)\n\n---\n\nüì¢ **Tone & Style**  \n- Professional luxury service tone  \n- Friendly but efficient responses  \n- No jargon, simple and clear language\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        224,
        0
      ],
      "id": "48d60bd0-65a9-4d4d-903a-3617c2002f52",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        96,
        208
      ],
      "id": "2d9d3d31-0884-470f-bd61-92f002cf147f",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "hMqeYnARM8ldcF0s",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        256,
        224
      ],
      "id": "23fa90f9-e0ea-4547-bba1-3856a76d213e",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "sendTo": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        736,
        144
      ],
      "id": "e6ff1ea4-aefa-4b03-a0fa-57320fd7a2c8",
      "name": "Send a Confirmation Email to customer",
      "webhookId": "50ef2d71-ac98-4121-b696-c5f13e69232b",
      "credentials": {
        "gmailOAuth2": {
          "id": "79h5BIrBoWN6krcH",
          "name": "Gmail account 3"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "15hmimWFgPmqbUfpB8XkgkIatLWmJHZcNkR6dFi_d2Ek",
          "mode": "list",
          "cachedResultName": "Barber Client Booking Sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/15hmimWFgPmqbUfpB8XkgkIatLWmJHZcNkR6dFi_d2Ek/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2114544795,
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/15hmimWFgPmqbUfpB8XkgkIatLWmJHZcNkR6dFi_d2Ek/edit#gid=2114544795"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Name', ``, 'string') }}",
            "Service": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Service', ``, 'string') }}",
            "Date": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Date', ``, 'string') }}",
            "Time": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Time', ``, 'string') }}",
            "Price": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Price', ``, 'string') }}",
            "Client Email": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Client_Email', ``, 'string') }}",
            "Client Phone No.": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Client_Phone_No_', ``, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Service",
              "displayName": "Service",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Time",
              "displayName": "Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Price",
              "displayName": "Price",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Client Email",
              "displayName": "Client Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Client Phone No.",
              "displayName": "Client Phone No.",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        416,
        240
      ],
      "id": "e59533c9-e8fc-454d-89a6-5b20a3d04652",
      "name": "Booking Clients",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i4VDcNtGkncidpHs",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "sendTo": "=abdbutt887@gmail.com",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "approvalOptions": {
          "values": {
            "approvalType": "double"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        576,
        208
      ],
      "id": "38806cf5-d04a-42f9-a76c-5a8ba808811b",
      "name": "Send a confirmation email to shop owner",
      "webhookId": "4418b073-6f64-4c52-be8a-bb78b87a7006",
      "credentials": {
        "gmailOAuth2": {
          "id": "79h5BIrBoWN6krcH",
          "name": "Gmail account 3"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Send a Confirmation Email to customer": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Booking Clients": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Send a confirmation email to shop owner": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "723bc6a2-49c6-4162-a175-eb408dd6e609",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "91c999ba8cb4641c259e7dc506cf1f39ca50377efc7ef2d47ec1f54d55729a26"
  },
  "id": "omblAUxrwlbfH50b",
  "tags": []
}